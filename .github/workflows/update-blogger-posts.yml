name: Debug Blogger API
on: workflow_dispatch

jobs:
  debug-api:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
    
    - name: Test API connection
      run: |
        echo "🔍 Debug: ¿Qué está devolviendo la API?"
        echo "Blog ID: $BLOG_ID"
        echo "API Key: ${API_KEY:0:10}..."
        
        URL="https://www.googleapis.com/blogger/v3/blogs/$BLOG_ID/posts?key=$API_KEY&maxResults=2"
        
        # Petición verbose
        curl -v "$URL" > debug-output.txt 2>&1
        
        echo "--- RESPUESTA COMPLETA ---"
        cat debug-output.txt
        echo "--- FIN RESPUESTA ---"
        
        # Petición para ver el JSON
        curl -s "$URL" > response.json
        echo "--- JSON RECIBIDO ---"
        cat response.json
        echo "--- FIN JSON ---"
        
        # Verificar estructura
        echo "¿Tiene items?: $(jq 'has("items")' response.json)"
        echo "Número de items: $(jq '.items | length' response.json)"
        
      env:
        API_KEY: ${{ secrets.BLOGGER_API_KEY }}
        BLOG_ID: ${{ vars.BLOGGER_BLOG_ID }}
