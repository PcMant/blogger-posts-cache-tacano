name: Test API Connection
on: workflow_dispatch

jobs:
  test-api:
    runs-on: ubuntu-latest
    steps:
    - name: Test Blogger API
      run: |
        echo "üîç Probando conexi√≥n con Blogger API..."
        echo "Blog ID: $BLOG_ID"
        echo "API Key: ${API_KEY:0:10}..."
        
        # Petici√≥n simple
        curl -s "https://www.googleapis.com/blogger/v3/blogs/$BLOG_ID/posts?key=$API_KEY&maxResults=1" > test_response.json
        
        echo "=== RESPUESTA ==="
        cat test_response.json
        
        echo "=== ¬øFUNCION√ì? ==="
        if jq -e '.items' test_response.json > /dev/null; then
          echo "‚úÖ ¬°API FUNCIONA!"
          echo "Posts: $(jq '.items | length' test_response.json)"
        else
          echo "‚ùå API NO FUNCIONA"
          echo "Error: $(jq '.error.message' test_response.json)"
        fi
      env:
        API_KEY: ${{ secrets.BLOGGER_API_KEY }}
        BLOG_ID: ${{ vars.BLOGGER_BLOG_ID }}
