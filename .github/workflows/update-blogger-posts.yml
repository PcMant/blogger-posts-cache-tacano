name: Debug Blogger Access
on: workflow_dispatch

jobs:
  debug-blogger:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout
      uses: actions/checkout@v4

    - name: Test API Access
      run: |
        echo "🔍 Probando acceso a Blogger API..."
        echo "Blog ID: ${{ vars.BLOGGER_BLOG_ID }}"
        echo "API Key: ${API_KEY:0:10}..."  # Primeros 10 caracteres
        
        # URL de la API
        URL="https://www.googleapis.com/blogger/v3/blogs/${{ vars.BLOGGER_BLOG_ID }}/posts?key=${{ secrets.BLOGGER_API_KEY }}&maxResults=10"
        echo "URL: ${URL:0:80}..."  # Mostrar parte de la URL
        
        # Hacer petición con headers detallados
        curl -v -s "$URL" -o debug-output.txt 2> debug-headers.txt
        
        echo "✅ Respuesta guardada"
        echo "--- HEADERS ---"
        cat debug-headers.txt
        echo "--- RESPONSE ---"
        cat debug-output.txt
        echo "--- END ---"
        
        # Verificar código HTTP
        HTTP_CODE=$(curl -s -o /dev/null -w "%{http_code}" "$URL")
        echo "📊 HTTP Code: $HTTP_CODE"
        
      env:
        API_KEY: ${{ secrets.BLOGGER_API_KEY }}
