name: DEBUG API Response
on: workflow_dispatch

jobs:
  debug-api:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
    
    - name: Debug API response
      run: |
        echo "üîç Debug completo de la API response..."
        echo "Blog ID: $BLOG_ID"
        echo "API Key: ${API_KEY:0:10}..."
        
        URL="https://www.googleapis.com/blogger/v3/blogs/$BLOG_ID/posts?key=$API_KEY&maxResults=5"
        
        # Hacer petici√≥n con verbose
        curl -v "$URL" > debug-full.log 2>&1
        curl -s "$URL" > response.json
        
        echo "=== HTTP RESPONSE ==="
        grep "HTTP/" debug-full.log
        
        echo "=== RESPONSE BODY ==="
        echo "Tama√±o: $(wc -c < response.json) bytes"
        echo "Primeras 10 l√≠neas:"
        head -10 response.json
        echo "..."
        
        echo "=== JSON STRUCTURE ==="
        jq '.' response.json | head -20
        
        echo "=== ITEMS CHECK ==="
        jq 'has("items")' response.json
        jq '.items | length' response.json
        jq '.items[0] | {title: .title, url: .url}' response.json
        
      env:
        API_KEY: ${{ secrets.BLOGGER_API_KEY }}
        BLOG_ID: ${{ vars.BLOGGER_BLOG_ID }}
